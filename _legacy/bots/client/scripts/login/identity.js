import { getToken } from './login';
import * as rest from '../rest/rest';
export default class Identity {
    constructor() {
        this.anonymous = true;
        this.token = null;
        this.username = null;
        this.getUsername = () => this.username;
        this.isAnonymous = () => this.anonymous;
        this.isLoggedIn = () => !this.anonymous;
    }
    logOut() {
        this.anonymous = true;
        this.username = null;
        this.token = null;
    }
    async login(username, password) {
        this.token = await getToken(username, password);
        this.username = username;
        this.anonymous = false;
    }
    sendRequest(path, method, data, headers) {
        return this.anonymous
            ? rest.send(path, method, data, headers)
            : rest.send(path, method, data, Object.assign({ 'Identity-Token': this.token }, headers));
    }
    post(path, data) {
        return this.sendRequest(path, 'POST', data);
    }
    get(path, data) {
        return this.sendRequest(path, 'GET', data);
    }
    put(path, data) {
        return this.sendRequest(path, 'PUT', data);
    }
    del(path, data) {
        return this.sendRequest(path, 'DELETE', data);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaWRlbnRpdHkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpZGVudGl0eS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBQ25DLE9BQU8sS0FBSyxJQUFJLE1BQU0sY0FBYyxDQUFBO0FBR3BDLE1BQU0sQ0FBQyxPQUFPO0lBQWQ7UUFFUyxjQUFTLEdBQVksSUFBSSxDQUFBO1FBQ3pCLFVBQUssR0FBVyxJQUFJLENBQUE7UUFDcEIsYUFBUSxHQUFrQixJQUFJLENBQUE7UUFFdEMsZ0JBQVcsR0FBRyxNQUFNLElBQUksQ0FBQyxRQUFRLENBQUE7UUFDakMsZ0JBQVcsR0FBRyxNQUFNLElBQUksQ0FBQyxTQUFTLENBQUE7UUFDbEMsZUFBVSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFBO0lBcUNuQyxDQUFDO0lBbkNBLE1BQU07UUFDTCxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQTtRQUNyQixJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQTtRQUNwQixJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQTtJQUNsQixDQUFDO0lBRUQsS0FBSyxDQUFDLEtBQUssQ0FBQyxRQUFnQixFQUFFLFFBQWdCO1FBQzdDLElBQUksQ0FBQyxLQUFLLEdBQUcsTUFBTSxRQUFRLENBQUMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUFBO1FBQy9DLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFBO1FBQ3hCLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFBO0lBQ3ZCLENBQUM7SUFFRCxXQUFXLENBQW9DLElBQVksRUFBRSxNQUFjLEVBQUUsSUFBVSxFQUFFLE9BQWE7UUFDckcsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTO2NBQ2xCLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDO2NBQ3RDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLGtCQUFJLGdCQUFnQixFQUFFLElBQUksQ0FBQyxLQUFLLElBQUssT0FBTyxFQUFHLENBQUE7SUFDL0UsQ0FBQztJQUVELElBQUksQ0FBb0MsSUFBWSxFQUFFLElBQVU7UUFDL0QsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUksSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQTtJQUMvQyxDQUFDO0lBRUQsR0FBRyxDQUFvQyxJQUFZLEVBQUUsSUFBVTtRQUM5RCxNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBSSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFBO0lBQzlDLENBQUM7SUFFRCxHQUFHLENBQW9DLElBQVksRUFBRSxJQUFVO1FBQzlELE1BQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFJLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUE7SUFDOUMsQ0FBQztJQUVELEdBQUcsQ0FBb0MsSUFBWSxFQUFFLElBQVU7UUFDOUQsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUksSUFBSSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQTtJQUNqRCxDQUFDO0NBR0QifQ==